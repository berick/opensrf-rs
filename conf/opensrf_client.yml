# vim:et:ts=2:sw=2:

message_bus:
  domain: private.localhost
  port: 6379
  username: opensrf@private
  password: password

logging:
  log4rs_config: conf/log4rs.yml


# ---- EXPERIMENTAL FORMAT -----

# Canned logging configs.
loggers:
  - name: service-logger
    loglevel: info
    syslog-facility: local0
    actlog-facility: local1
  - name: gateway-logger
    loglevel: info
    syslog-facility: local6
    actlog-facility: local1
  - name: router-logger
    loglevel: info
    syslog-facility: local2

# Domains where the message bus operates.
# Domain names are free-form and only used in this configuration file
# to link domains to accounts, connections, and routers.
domains:
  - name: public-domain
    host: public.localhost
    port: 6379
  - name: private-domain
    host: private.localhost
    port: 6379

# Accounts are used for logging in to the message bus.  Account
# names are only used in this configuration file to link accounts to
# connections and routers.
accounts:
  - name: public-account
    domain: public-domain
    username: opensrf@public
    password: password
  - name: private-account
    domain: private-domain
    username: opensrf@private
    password: password

# Some connections have well-known names ("service", "gateway", "srfsh"),
# but additional connections can be added for use with scripts and other
# custom clients.
connections:
  - name: service
    account: private-account
    logger: service-logger
  - name: gateway
    account: public-account
    logger: gateway-logger
  - name: srfsh
    account: private-account
    logger: service-logger

# One router per domain.  Domain is implied by the account.
routers:
  - account: private-account
    logger: router-logger
  - account: public-account
    logger: router-logger
    # Only services in this group should register with this router.
    services: public-services

# Named groups of services.
service-groups:
  - name: public-services
    services:
      - opensrf.math
      - open-ils.actor
      - open-ils.acq
      - open-ils.auth
      - open-ils.auth_proxy
      - open-ils.booking
      - open-ils.cat
      - open-ils.circ
      - open-ils.collections
      - open-ils.courses
      - open-ils.curbside
      - open-ils.ebook_api
      - open-ils.fielder
      - open-ils.pcrud
      - open-ils.permacrud
      - open-ils.reporter
      - open-ils.resolver
      - open-ils.search
      - open-ils.serial
      - open-ils.supercat
      - open-ils.url_verify
      - open-ils.vandelay

# Avoid logging parameters for API calls (at or below INFO level) whose
# API name is a left-anchored match to any of the following method names.
log-protect:
  - open-ils.auth.authenticate.verify
  - open-ils.auth.authenticate.complete
  - open-ils.auth.login
  - open-ils.auth_proxy.login
  - open-ils.actor.patron.password_reset.commit
  - open-ils.actor.user.password
  - open-ils.actor.user.username
  - open-ils.actor.user.email
  - open-ils.actor.patron.update
  - open-ils.cstore.direct.actor.user.create
  - open-ils.cstore.direct.actor.user.update
  - open-ils.cstore.direct.actor.user.delete
  - open-ils.search.z3950.apply_credentials
  - open-ils.geo
  - open-ils.actor.geo

