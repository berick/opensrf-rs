# vim:et:ts=2:sw=2:

message_bus:
  domain: private.localhost
  port: 6379
  username: opensrf@private
  password: password

logging:
  log4rs_config: conf/log4rs.yml


# ---- EXPERIMENTAL FORMAT

message-bus: 

  # Domains where the message bus operates.
  # Domain names are free-form and only used in this configuration file
  # to link domains to accounts, connections, and routers.
  domains:
    - name: public-domain
      host: public.localhost
      port: 6379
    - name: private-domain
      host: private.localhost
      port: 6379

  # Accounts are used for logging in to the message bus.
  # Account name are free-from and only used in this configuration file to
  # link accounts to connections and routers.
  accounts:
    - name: public-account
      domain: public-domain
      username: opensrf@public
      password: password
    - name: private-account
      domain: private-domain
      username: opensrf@private
      password: password

  # Some connections have well-known names ("service", "gateway", "srfsh"),
  # but other free-form names can be added.
  # Bus domain is implied by the 'account'.
  connections:
    - name: service
      account: private-account
      logging:
        logfile: syslog
        loglevel: debug
        syslog-facility: local0
        actlog_facility: local1
    - name: gateway
      account: public-account
      logging:
        logfile: syslog
        loglevel: info
        syslog-facility: local6
        actlog_facility: local1
    - name: srfsh
      account: private-account
      logging:
        logfile: /openils/var/log/srfsh.log
        loglevel: debug

  # Router names are used as part of the destination address for each
  # router during service registration, deregistration, and other 
  # router-specific commands.
  # A single domain can host multiple routers.
  # Bus domain is implied by the 'account'.
  routers:
    - name: private-router
      account: private-account
      services: *
      logging:
        logfile: syslog
        loglevel: info
        syslog-facility: local2
    - name: public-router
      account: public-account
      services: public-services
      logging:
        logfile: syslog
        loglevel: info
        syslog-facility: local2

service-groups:
  - name: public-services
    services:
      - opensrf.math
      - open-ils.actor
      - open-ils.acq
      - open-ils.auth
      - open-ils.auth_proxy
      - open-ils.booking
      - open-ils.cat
      - open-ils.circ
      - open-ils.collections
      - open-ils.courses
      - open-ils.curbside
      - open-ils.ebook_api
      - open-ils.fielder
      - open-ils.pcrud
      - open-ils.permacrud
      - open-ils.reporter
      - open-ils.resolver
      - open-ils.search
      - open-ils.serial
      - open-ils.supercat
      - open-ils.url_verify
      - open-ils.vandelay

log-protect:
  - open-ils.auth.authenticate.verify
  - open-ils.auth.authenticate.complete
  - open-ils.auth.login
  - open-ils.auth_proxy.login
  - open-ils.actor.patron.password_reset.commit
  - open-ils.actor.user.password
  - open-ils.actor.user.username
  - open-ils.actor.user.email
  - open-ils.actor.patron.update
  - open-ils.cstore.direct.actor.user.create
  - open-ils.cstore.direct.actor.user.update
  - open-ils.cstore.direct.actor.user.delete
  - open-ils.search.z3950.apply_credentials
  - open-ils.geo
  - open-ils.actor.geo

