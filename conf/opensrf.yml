# vim:et:ts=2:sw=2:

message-bus:

  # List all routable domains in our cluster.
  # We assume one OpenSRF Router is running on each of domain.
  #
  # If a Domain has a "hosted-services" entry, those are the only services
  # that will launch themselves on the domain.  By default, all services
  # run on each domain.
  domains:
    - name: private.localhost
    - name: public.localhost
      hosted-services: public-services
    # port: 6379

  # Credentials used for logging in to the message bus.
  # Credentials must be consistent across all domains for x-domain routing.
  #
  # Account names are free-form and have no meaning outside of this 
  # configuration file.
  #
  # Account usernames are only used for logging in to Redis, where 
  # read/write permissions are enforced per account.  The usernames
  # have no meaning within the application.
  credentials:
    private-account:
      username: opensrf@private
      password: password
    public-account:
      username: opensrf@public
      password: password

  # Well-known connection types, with option to define custom types
  # for use with local scripts, etc.
  #
  # These link connection types to their bus credentials and define
  # their logging configs.
  connections:
    service:
      credentials: private-account
      loglevel: trace
      syslog-facility: local0
      actlog-facility: local1
    gateway:
      credentials: public-account
      loglevel: info
      syslog-facility: local6
      actlog-facility: local1
    srfsh:
      credentials: private-account
      loglevel: debug
      syslog-facility: local0
    router:
      credentials: private-account
      loglevel: trace
      syslog-facility: local2

# Named groups of services.
# Names are free-form and have no meaning outside of this configuration file.
service-groups:
  public-services:
    - opensrf.public
#    - opensrf.math
#    - open-ils.actor
#    - open-ils.acq
#    - open-ils.auth
#    - open-ils.auth_proxy
#    - open-ils.booking
#    - open-ils.cat
#    - open-ils.circ
#    - open-ils.collections
#    - open-ils.courses
#    - open-ils.curbside
#    - open-ils.ebook_api
#    - open-ils.fielder
#    - open-ils.pcrud
#    - open-ils.permacrud
#    - open-ils.reporter
#    - open-ils.resolver
#    - open-ils.search
#    - open-ils.serial
#    - open-ils.supercat
#    - open-ils.url_verify
#    - open-ils.vandelay

# Avoid logging parameters for API calls (at or below INFO level) whose
# API name is a left-anchored match to any of the following method names.
log-protect:
  - open-ils.auth.authenticate.verify
  - open-ils.auth.authenticate.complete
  - open-ils.auth.login
  - open-ils.auth_proxy.login
  - open-ils.actor.patron.password_reset.commit
  - open-ils.actor.user.password
  - open-ils.actor.user.username
  - open-ils.actor.user.email
  - open-ils.actor.patron.update
  - open-ils.cstore.direct.actor.user.create
  - open-ils.cstore.direct.actor.user.update
  - open-ils.cstore.direct.actor.user.delete
  - open-ils.search.z3950.apply_credentials
  - open-ils.geo
  - open-ils.actor.geo

services:
  opensrf.rsprivate:
    lang: rust
    keepalive: 5
    workers:
      min: 1
      max: 20
      min-idle: 1
      max-idle: 5
      max-requests: 1000
  opensrf.rspublic:
    lang: rust
    keepalive: 5
    workers:
      min: 1
      max: 20
      min-idle: 1
      max-idle: 5
      max-requests: 1000
